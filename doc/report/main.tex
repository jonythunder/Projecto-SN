\documentclass{article}

\input{preamble}

\begin{document}

\thispagestyle{empty}

\includegraphics[viewport=9.5cm 11cm 0cm 0cm,scale=0.29]{IST_A_CMYK_POS}
	
\begin{center}
	\vspace{70mm} % --  Espaço em branco
	\rule{\linewidth}{0.5pt} \\
    \vspace{2mm}
	\Huge \textsc{Projecto de Sistemas de Navegação} \\
	\rule{\linewidth}{2pt} \\
	\vspace{8mm} % -- Espaço em branco
	\LARGE Desenvolvimento de um sistema de detecção de intromissão em áreas restritas baseado em GPS diferencial
	
	\vspace{\fill} % --  Espaço em branco variável
	\large
	
	\begin{tabular}{r l}
		Tiago \textsc{Matias} & \textbf{65655} \\
		João \textsc{Manito} & \textbf{73096} \\
		Daniel \textsc{de Schiffart} & \textbf{81479}
	\end{tabular}
	
	\vspace{10mm} % --  Espaço em branco
	\Large Instituto Superior Técnico \\
	Mestrado em Engenharia Aeroespacial \\
	\vspace{1mm}
	\large Sistemas de Navegação
	
	\vspace{10mm} % --  Espaço em branco
	\Large Junho de 2018
\end{center}

\newpage

\section{Objectivo}

O objetivo do projeto é a implementação de um sistema de
posicionamento global derivado do GPS com correções baseadas em
estações locais, um sistema comummente apelidado de GPS diferencial,
ou DGPS, e a utilização desse mesmo sistema para detetar intrusão em
áreas pré-especificadas.

\section{Funcionamento}

Neste projeto implementámos melhoramentos de GPS através do método
conhecido como GPS diferencial. GPS diferencial é um sistema para
corrigir a posição retornada por um recetor GPS convencional. Este
sistema utiliza um recetor de posição fixa pré-determinada para
calcular erros nos \textit{pseudoranges} em tempo real.

\subsection{GPS Diferencial}

A correção é realizada nos valores dos \textit{pseudoranges}
calculados pelo recetor local através dos satélites do sistema GPS.
Estes erros, que advêm do facto da influência da atmosfera no sinal
de GPS não ser constante, são calculados pela diferença dos
\textit{pseudoranges} da estação fixa e a distância real desta aos
satélites, cuja posição é conhecida pois esta está presente no sinal
de GPS. Uma vez calculados estes erros, estes são transmitidos ao
recetor local e subtraídos aos \textit{pseudoranges} calculados por
este. Calcula-se então a posição utilizando o método de GPS, mas
utilizando desta vez os \textit{pseudoranges} corrigidos.

Sendo $d_{GS}$ a distância entre o satélite $N$ e a
estação local, e $\rho_{GS}$ o \textit{pseudorange} obtido nesta, temos,
para cada satélite, o erro $e$ na equação \ref{sat_error}.
\begin{gather} \label{sat_error}
	\left[\begin{matrix}
		e^{(1)} \\
        e^{(2)} \\
        \vdots \\
        e^{(N)} \\
	\end{matrix}\right]
	= \left[\begin{matrix}
		d^{(1)}_{GS} - \rho^{(1)}_{GS} \\
        d^{(2)}_{GS} - \rho^{(2)}_{GS} \\
        \vdots \\
        d^{(N)}_{GS} - \rho^{(N)}_{GS} \\
	\end{matrix}\right]
\end{gather}
Sendo $\rho^{(N)}_{r}$ o \textit{pseudorange} obtido pelo receptor local, temos $\rho*_r $ como o valor corrigido para o receptor local do \textit{pseudorange}, na equação \ref{new_range}.
\begin{gather} \label{new_range}
	\left[\begin{matrix}
		\rho*^{(1)}_r \\
        \rho*^{(2)}_r \\
        \vdots \\
        \rho*^{(N)}_r \\
	\end{matrix}\right]
	= \left[\begin{matrix}
		\rho^{(1)}_{r} - e^{(1)} \\
        \rho^{(2)}_{r} - e^{(2)} \\
        \vdots \\
        \rho^{(N)}_{r} - e^{(N)} \\
	\end{matrix}\right]
\end{gather}
Com estes novos \textit{pseudoranges} podemos calcular a posição do receptor local da mesma forma que seria calculada no caso de GPS normal.

\subsection{Verificação de Intrusão de Área}

Para determinar a intrusão de um ponto em áreas restritas, foram
formuladas equações com base nas coordenadas ECEF calculadas pelo
DGPS. Estas equações foram formuladas para três tipos de volumes
geométricos distintos: esfera, cilindro e paralelepípedo (caixa).

\subsubsection{Esfera}

O cálculo da intrusão num volume esférico com base em coordenadas
ECEF foi de relativa facilidade, e foi consequentemente a primeira a
ser implementada. Fornecendo um ponto $(x_c,y_c,z_c)$ para o centro
da esfera e um raio $r$, para uma coordenada $(x_r,y_r,z_r)$
fornecida pelo recetor, podemos formular que o ponto está dentro da 
esfera se
\begin{gather*}
	\left\lVert(x_c,y_c,z_c) - (x_r,y_r,z_r)\right\rVert \leq r
\end{gather*}

\subsubsection{Cilindro}

A implementação do cilindro foi feita através de um ponto $(x_b,y_b,
z_b)$ correspondente à base, um raio da base $r$, e uma altura $h$.
A verificação da intrusão foi feita utilizando uma fatia circular do
cilindro com a mesma altura em LLH. Utilizando o centro desta mesma fatia
$(x_f,y_f,z_f)$, formula-se que o ponto está dentro do cilindro se
\begin{gather*}
	\left\lVert(x_f,y_f,z_f) - (x_r,y_r,z_r)\right\rVert \leq r
\end{gather*}

\subsubsection{Paralelepípedo}

A última implementação foi a do paralelepípedo, que foi a menos trivial a
realizar. O algoritmo de deteção utilizado requer um paralelepípedo
ortonormado. Para tal, trabalhou-se no sistema de coordenadas ENU.
Utilizando dois pontos $P_1$ e $P_3$ e a altura $h$ do
paralelepípedo obtiveram-se oito pontos que definem o paralelepípedo,
como se observa na figura \ref{fig:box}.

%if dot(u_ENU,xyz_ENU)>=dot(u_ENU,corners_ENU(1,:)) && dot(u_ENU,xyz_ENU)<=dot(u_ENU,corners_ENU(2,:))
%    if dot(v_ENU,xyz_ENU)>=dot(v_ENU,corners_ENU(1,:)) && dot(v_ENU,xyz_ENU)<=dot(v_ENU,corners_ENU(4,:))
%        if dot(w_ENU,xyz_ENU)>=dot(w_ENU,corners_ENU(1,:)) && dot(w_ENU,xyz_ENU)<=dot(w_ENU,corners_ENU(5,:))

\begin{figure}[ht]
	\centering
	\begin{tikzpicture}[ppoint/.style = {circle,draw,inner sep = 0pt, minimum size = 3pt}]
		\node (p1) at (0,0) [ppoint,label = {135:$P_1$}] {};
        \node (p2) at (1,1) [ppoint,label = {135:$P_2$}] {};
        \node (p3) at (3,1) [ppoint,label = {135:$P_3$}] {};
        \node (p4) at (2,0) [ppoint,label = {135:$P_4$}] {};
        \node (p5) at (0,3) [ppoint,label = {135:$P_5$}] {};
        \node (p6) at (1,4) [ppoint,label = {135:$P_6$}] {};
        \node (p7) at (3,4) [ppoint,label = {135:$P_7$}] {};
        \node (p8) at (2,3) [ppoint,label = {135:$P_8$}] {};
        \draw (p1) -- (p5) -- (p6) -- (p7) -- (p3) -- (p4) -- (p1);
        \draw (p5) -- (p8) -- (p7) (p8) -- (p4);
        \draw [dashed] (p1) -- (p2) -- (p6) (p2) -- (p3);
        \draw [<->] (p3) ++(0.5,0) -- node [auto,swap] {$h$} ++(0,3);
	\end{tikzpicture}
    \caption{Relação entre os pontos do paralelepípedo.}
    \label{fig:box}
\end{figure}

Utilizando um ponto do recetor $P_r = (x_r,y_r,z_r)$, as condições de
intrusão podem ser definidas extraindo três vetores $u$, $v$ e $y$ do
paralelepípedo.
\begin{gather*}
	u = P_1 - P_2 \\
    v = P_1 - P_4 \\
    w = P_1 - P_5
\end{gather*}

Com isto definido, o ponto do recetor pode ser considerado dentro do
paralelepípedo quando todas as condições das equações \ref{eq:box_condu},
\ref{eq:box_condv} e \ref{eq:box_condw} são correspondidas.
\begin{gather}
	\label{eq:box_condu}
	u \cdot P_1 \leq u \cdot P_r \leq u \cdot P_2 \\
    \label{eq:box_condv}
    v \cdot P_1 \leq v \cdot P_r \leq v \cdot P_4 \\
    \label{eq:box_condw}
    w \cdot P_1 \leq w \cdot P_r \leq w \cdot P_5
\end{gather}

\section{Implementação}

A implementação do DGPS foi realizada com recurso ao MATLAB,
reutilizando parte do código desenvolvido ao longo do semestre nas
aulas da unidade curricular. Numa instância inicial, foram
utilizados dados fornecidos pelo professor para as posições dos
satélites e para os \textit{pseudoranges} de alguns satélites,
obtidos através da estação GNSS colocada no topo do Instituto de
Telecomunicações, como descrita no documento
\texttt{AntennaSurvey.pdf}.

\end{document}
